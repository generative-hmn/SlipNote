# SlipNote - 설계 명세서 v1.0

---

## 1. 제품 개요

**한 줄 정의**: 메뉴바에 상주하며 즉시 메모를 캡처하는 맥 전용 스크래치패드

**핵심 철학**
- 마찰 최소화: 떠오른 생각을 0.5초 내에 캡처 시작
- 슬립 단위: 각 메모는 독립적인 카드, 타임스탬프로 식별
- 버전 보존: 수정 시 덮어쓰지 않고 스택으로 히스토리 유지

---

## 2. 기능 요구사항

### 핵심 기능

| 기능 | 설명 |
|------|------|
| 빠른 캡처 | 글로벌 단축키로 어디서든 입력창 호출 |
| 슬립 생성 | 타임스탬프 + 첫 줄 타이틀 자동 생성 |
| 카테고리 | 0-9 단축키로 10개 카테고리 분류 |
| 버전 스택 | 수정 시 새 버전 생성, 이전 버전 보존 |
| 풀텍스트 검색 | 입력창에서 `/검색어`로 즉시 검색 |
| 뷰 모드 | 피드 스타일로 슬립 탐색 |

### 부가 기능

| 기능 | 설명 |
|------|------|
| 카테고리 커스텀 | 이름, 이모지, 단축키 사용자 지정 |
| 카테고리 이동 | 뷰 모드에서 `⌘+숫자` 또는 드래그 |
| 내보내기 | 마크다운 형식 지원 |

---

## 3. 사용자 플로우

### 3.1 슬립 생성

```
[1] ⌘+Shift+N (글로벌 단축키)
         ↓
[2] 입력창 나타남, 커서 포커스
         ↓
[3] 텍스트 입력 (여러 줄 가능)
         ↓
[4] ⌘+Enter
         ↓
[5] 카테고리 바 나타남 [0]📥 [1]💼 [2]💡 ...
         ↓
[6] 숫자 키 또는 ESC(기본 카테고리)
         ↓
[7] 슬립 생성 완료, 창 닫힘
```

### 3.2 검색

```
[1] ⌘+Shift+N
         ↓
[2] /검색어 입력
         ↓
[3] 실시간 검색 결과 드롭다운
         ↓
[4] ↑↓ 탐색, Enter 선택
         ↓
[5] 뷰 모드로 전환, 해당 슬립 하이라이트
```

### 3.3 뷰 모드

```
[1] 메뉴바 아이콘 클릭
         ↓
[2] 피드 스타일 팝업
         ↓
[3] 스크롤 탐색 / 상단 검색창 / 카테고리 필터
         ↓
[4] 슬립 클릭 → 상세 보기 (버전 네비게이션 포함)
```

### 3.4 슬립 수정

```
[1] 뷰 모드에서 슬립 선택
         ↓
[2] 편집 진입 (더블클릭 또는 단축키)
         ↓
[3] 내용 수정
         ↓
[4] ⌘+Enter 저장
         ↓
[5] 새 버전 생성, 이전 버전은 스택에 보존
```

### 3.5 카테고리 변경

```
뷰 모드에서:
- 슬립 선택 후 ⌘+숫자 → 즉시 이동
- 또는 슬립을 사이드바 카테고리로 드래그
```

---

## 4. 데이터 설계

### 4.1 저장소

**SQLite** 단일 파일: `~/Library/Application Support/SlipNote/slipnote.db`

### 4.2 스키마

```sql
-- 카테고리
CREATE TABLE categories (
  id INTEGER PRIMARY KEY,        -- 0-9
  name TEXT NOT NULL,
  emoji TEXT,
  sort_order INTEGER
);

-- 슬립
CREATE TABLE slips (
  id TEXT PRIMARY KEY,           -- UUID
  timestamp TEXT NOT NULL,       -- "250120_1432"
  title TEXT NOT NULL,           -- 첫 줄 자동 추출
  content TEXT NOT NULL,
  category_id INTEGER DEFAULT 0,
  created_at DATETIME,
  updated_at DATETIME,
  FOREIGN KEY (category_id) REFERENCES categories(id)
);

-- 버전 히스토리
CREATE TABLE versions (
  id TEXT PRIMARY KEY,
  slip_id TEXT NOT NULL,
  timestamp TEXT NOT NULL,
  content TEXT NOT NULL,
  created_at DATETIME,
  FOREIGN KEY (slip_id) REFERENCES slips(id) ON DELETE CASCADE
);

-- 풀텍스트 검색 인덱스
CREATE VIRTUAL TABLE slips_fts USING fts5(
  title,
  content,
  content=slips,
  content_rowid=rowid
);
```

### 4.3 타임스탬프 포맷

```
[YYMMDD_HHmm]
예: [250120_1432] = 2025년 1월 20일 14시 32분
```

---

## 5. UI 명세

### 5.1 입력창 (Spotlight 스타일)

**위치**: 화면 중앙 상단  
**크기**: 너비 600px, 높이 동적 (최소 1줄, 최대 10줄)

```
┌────────────────────────────────────────────────────┐
│ 텍스트 입력 영역                                   │
│ 여러 줄 가능                                       │
│ ▌                                                  │
└────────────────────────────────────────────────────┘
```

**⌘+Enter 후 카테고리 선택 바**:

```
┌────────────────────────────────────────────────────┐
│ [0]📥 [1]💼 [2]💡 [3]📝 [4]🎯 [5]... [ESC 기본]   │
└────────────────────────────────────────────────────┘
```

**검색 모드** (`/` 입력 시):

```
┌────────────────────────────────────────────────────┐
│ /캐싱▌                                             │
├────────────────────────────────────────────────────┤
│ 💡 [250120_1432] GraphQL 캐싱 전략                 │
│ 💼 [250118_0915] Redis 캐싱 설정          ← 선택   │
│ 💼 [250112_1620] CDN 캐싱 정책 회의                │
└────────────────────────────────────────────────────┘
```

### 5.2 뷰 모드 (팝업)

**위치**: 메뉴바 아이콘 아래 드롭다운 또는 별도 윈도우  
**크기**: 400px × 600px (조절 가능)

```
┌──────────────────────────────────────────────┐
│ 🔍 검색...              [전체 ▾]      [⚙️]  │
├──────────────────────────────────────────────┤
│                                              │
│ ┌──────────────────────────────────────────┐ │
│ │ 💡 GraphQL 캐싱 전략          250120_1432│ │
│ │                                          │ │
│ │ 퍼시스턴트 쿼리 적용하면 CDN 캐싱        │ │
│ │ 가능할듯                                 │ │
│ │                                    [v2]  │ │
│ └──────────────────────────────────────────┘ │
│                                              │
│ ┌──────────────────────────────────────────┐ │
│ │ 💼 API 설계 변경안            250120_1201│ │
│ │                                          │ │
│ │ REST에서 GraphQL로 변경 결정             │ │
│ │ - 클라이언트 요청 단순화                 │ │
│ │                                    [v3]  │ │
│ └──────────────────────────────────────────┘ │
│                                              │
│                     ...                      │
└──────────────────────────────────────────────┘
```

### 5.3 슬립 상세 (버전 타임머신)

```
┌──────────────────────────────────────────────┐
│ ← 목록                          💡 Ideas     │
├──────────────────────────────────────────────┤
│                                              │
│ GraphQL 캐싱 전략                            │
│ ─────────────────────────────────────────    │
│ 250120_1432                                  │
│                                              │
│ 퍼시스턴트 쿼리 적용하면 CDN 캐싱 가능할듯   │
│ Apollo Client의 automatic persisted         │
│ queries 기능 활용                            │
│                                              │
│                                              │
├──────────────────────────────────────────────┤
│   ◀ v1 (250120_1030)  │ v2 현재 │           │
└──────────────────────────────────────────────┘
```

### 5.4 설정

```
┌──────────────────────────────────────────────┐
│ 설정                                         │
├──────────────────────────────────────────────┤
│                                              │
│ 글로벌 단축키                                │
│ ┌──────────────────────────────────────────┐ │
│ │ ⌘ + Shift + N                     [변경] │ │
│ └──────────────────────────────────────────┘ │
│                                              │
│ 카테고리                                     │
│ ┌──────────────────────────────────────────┐ │
│ │ [0] 📥 Inbox            (기본)           │ │
│ │ [1] 💼 Work                              │ │
│ │ [2] 💡 Ideas                             │ │
│ │ [3] 📝 Notes                             │ │
│ │ [4] 🎯 Tasks                             │ │
│ │ [5] 📚 Learn                             │ │
│ │ [6] _______________                      │ │
│ │ [7] _______________                      │ │
│ │ [8] _______________                      │ │
│ │ [9] _______________                      │ │
│ └──────────────────────────────────────────┘ │
│                                              │
│ 데이터                                       │
│ [마크다운 내보내기]  [백업]  [복원]          │
│                                              │
└──────────────────────────────────────────────┘
```

---

## 6. 키보드 단축키

### 글로벌

| 단축키 | 동작 |
|--------|------|
| `⌘+Shift+N` (기본) | 입력창 열기 |

### 입력창

| 단축키 | 동작 |
|--------|------|
| `⌘+Enter` | 저장 → 카테고리 선택 |
| `0-9` | 카테고리 선택 (카테고리 바 활성 시) |
| `ESC` | 기본 카테고리로 저장 또는 취소 |
| `/` | 검색 모드 진입 |

### 검색 모드

| 단축키 | 동작 |
|--------|------|
| `↑` `↓` | 결과 탐색 |
| `Enter` | 선택한 슬립으로 뷰 모드 |
| `ESC` | 검색 취소 |

### 뷰 모드

| 단축키 | 동작 |
|--------|------|
| `⌘+0-9` | 선택한 슬립 카테고리 변경 |
| `⌘+F` | 검색 포커스 |
| `⌘+Backspace` | 삭제 (확인 필요) |
| `Enter` | 선택한 슬립 상세 보기 |
| `ESC` | 창 닫기 |

---

## 7. 기술 스택

| 레이어 | 선택 | 이유 |
|--------|------|------|
| 언어 | Swift | 맥 네이티브, 성능 |
| UI | SwiftUI + AppKit | 모던 UI + 메뉴바 지원 |
| 데이터 | SQLite + GRDB | FTS5 검색, Swift 친화적 |
| 단축키 | HotKey (라이브러리) | 글로벌 단축키 처리 |
| 메뉴바 | NSStatusItem | 네이티브 메뉴바 상주 |

---

## 8. 엣지 케이스 처리

| 상황 | 처리 |
|------|------|
| 빈 내용으로 저장 시도 | 무시, 창 유지 |
| 동일 초에 여러 슬립 생성 | 타임스탬프에 초 추가 (`250120_143201`) |
| 검색 결과 없음 | "결과 없음" 표시, 새 슬립 생성 제안 |
| 삭제 시도 | 확인 다이얼로그 필수 |
| 창 외부 클릭 | 입력 중이면 유지, 빈 상태면 닫기 |
| 앱 재시작 | 마지막 상태 복원 불필요 (항상 fresh start) |

---

## 9. 기본 카테고리 프리셋

| ID | 이모지 | 이름 | 용도 |
|----|--------|------|------|
| 0 | 📥 | Inbox | 기본, 미분류 |
| 1 | 💼 | Work | 업무 |
| 2 | 💡 | Ideas | 아이디어 |
| 3 | 📝 | Notes | 일반 메모 |
| 4 | 🎯 | Tasks | 할 일 |
| 5 | 📚 | Learn | 학습 |
| 6-9 | - | (미설정) | 사용자 정의 |

---

## 10. 향후 확장 고려

지금 구현하지 않지만 구조적으로 열어둘 것:

- iCloud 동기화
- 태그 시스템
- 슬립 간 링크
- 위젯
- 공유 익스텐션 (Safari 등에서 바로 캡처)

---

## 부록: 참고 레퍼런스

| 앱 | 참고 포인트 |
|----|-------------|
| Tot | 미니멀 메뉴바 메모 |
| Drafts | "캡처 후 정리" 철학 |
| Raycast | 스팟라이트 스타일 입력 UX |
| Zettelkasten | 슬립 카드 개념 |
| macOS Time Machine | 버전 스택 UI |
